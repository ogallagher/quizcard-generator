# Quiz Card Generator (español)

Dado un documento fuente, genera cartas de prueba/memorización. Actualmente está diseñado específicamenta para **aprender idiomas**, así que el mejor material candidato para usar como entrada serán opciones como los siguientes, en el idioma destino:

- Guiones de películas
- Archivos de subtítulos
- Capítulos de libros
- Artículos de periódicos y revistas

[quizgen\_webui\_demo\_2024-02-11.fps-15](https://github.com/ogallagher/quizcard-generator/assets/17031438/dd0d440a-a198-428e-96ed-6a5f92b3ec1c)

## Instalación

Disponible como librería en [npm](https://npmjs.org).

```shell
npm install --global --omit dev quizcard-generator
# quizcard-generator ahora debe de estar disponible en la ruta de ejecución del usuario
quizcard-generator --help
```

### Descargar

Una alternativa es descargar y compilar el código fuente.

```shell
# descargar repo de código
git clone https://github.com/ogallagher/quizcard-generator

# instalar dependencias
npm install
# Hay también varias dependencias opcionales incluyendo yargs,
# la cual se requiere para ejecutar el generador como programa independiente/de entrada.
npm install yargs
```

### Compilar TypeScript y plantillas de cartas

El código se provee como archivos typescript, los cuales deben compilarse a javascript antes de ejecución

```shell
# typescript ya debe de estar instalada por paso anterior
# npm install typescript

npm run build
```

## Utilizar

Instrucciones a continuación suponen el uso del programa CLI, pero tal como se demostró en el video arriba, hay también una UI web en [wordsearch.dreamhosters.com/quizcard-generator](https://wordsearch.dreamhosters.com/quizcard-generator), que le da un interfaz encima del programa CLI.

Para ver todas las opciones disponibles, véase `node quizcard_generator.js --help` (o `quizcard-generator --help` si siguió las instrucciones para la instalación global desde NPM arriba).

### Documento fuente

Encuentre/cree y descargue un **documento fuente**. Solo el formato de texto simple `utf-8` se admite actualmente. Hay un par de ejemplos en `docs/examples/<lang>_source.txt`.

La ruta al documento se ingresa por `--input-file`.

### Exclusiones

Si uno sabe algunas palabras que no deben incluirse como vocabulario evaluable, se las puede especificar individualmente usando la opción `--exclude-word`, pero es más conveniente enumerarlas en una o más archivos de exclusiones, ingresando cada ruta al archivo de exclusiones por `--excludes-file`.

> Archivo de exclusiones ejemplar

```txt
# comentarios empiezan con '#' el inicio de la línea
cada
palabra
o
/reg(ular)?exp(ression)?/
# está en su propia línea
```

### Ejecutar Quiz Card Generator desde CLI

El `quizcard_generator.js` puede importarse tanto como correrse como programa de entrada. 

En el último case, la mayoría de la ejecución será canalizada por `quizcard_cli.js`, pero este segundo archivo no es de veras una envoltura; es una dependencia opcional usada para ejecución en cli. Admito que este flujo de control puede ser un tanto confuso.

> Ejecución de quiz card generator cli ejemplar

```shell
# compilación no necesaria a menos que archivos de fuente hayan cambiado desde la última compilación
npm run build

# ejecutar quiz card generator
node quizcard_generator.js \
# con archivo coreano de exclusiones ejemplar
--excludes-file "docs/examples/kor_source_excludes.txt" \
--input-file "docs/examples/kor_source.txt" \
# aquí especifico el nombre del resultado
--anki-notes-name kor-example-1 \
--log-level info
```

El singular archivo de resultado actualmente generado se encontrará en:

```txt
out/anki/notes/fill-blanks/<anki-notes-name>.txt
```

### Integraciones - Anki

Info de cartas de memoria generada debe importarse en [Anki](https://ankiweb.net) para ser usada.

El archivo de resultado de la ejecución del generador es un [archivo notas Anki](https://docs.ankiweb.net/importing/text-files.html), que va a requerir un par de pasos preparativos dentro de Anki para servir al importarse.

#### 1. Create note type `fill-blanks` from base type `Cloze`

<img src="docs/img/tools_note-types.jpg" alt="tools &gt; manage note types"/>

<img src="docs/img/note-type_add.jpg" alt="manage note types &gt; add"/>

<img src="docs/img/add_cloze.jpg" alt="add note type from base type cloze"/>

The note type name `fill-blanks` is to what the notes can be automatically assigned on import, which maps the file columns to field names.

#### 2. Define fields belonging to `fill-blanks` note type

<img src="docs/img/note-type_fields.jpg"/>

The order of these fields must match the column **order** in the notes file generated by `quizcard-generator`:

- euid
- notetype _(meta field, omit)_
- tags _(meta field, omit)_
- text
- choices
- source-file
- source-line
- translations
- prologue
- epilogue

The **names** are also important, as they are referenced inside the card templates used to generate the quiz/flash cards from the notes. The options for each field mostly do not matter and are related to display within the Anki browser/navigator.

<img src="docs/img/fill-blank_fields.jpg"/>

#### 3. Define card templates belonging to `fill-blanks` note type

<img src="docs/img/note-type_cards.jpg" alt="manage note types &gt; cards (card types)">

As mentioned before, the card templates are quiz cards are generated from these notes. The files in `anki/card_templates/fill-blanks/` can be pasted into the 3 corresponding text inputs for defining the card templates.

- `front.html` &rarr; **Front template**
- `back.html` &rarr; **Back template**
- `style.css` &rarr; **Styling**

<img src="docs/img/fill-blank_card-templates.jpg" alt="fill-blanks card templates editor">

#### 4. Import notes file to Anki

Finally, return to the Anki main window and press **Import File** to select the file generated by `quizcard-generator` (in the above example, `out/anki/notes/fill-blanks/kor-example-1.txt`). The default settings should not need to be modified.

<img src="docs/img/import_kor-example-1.jpg" alt="notes file import window">

After importing, find the imported notes in the Anki browser to confirm the fields were correctly imported. Then, check out some card previews!

<img src="docs/img/preview-card_kor-example-1_2.jpg" alt="">

If you want to make bulk adjustments to these notes at the notes file generation step, you can generate a new/replacement notes file to `out/anki/notes/fill-blanks/`, which will have the updated notes. When the updated notes are imported into Anki, they are uniquely identified with the `euid` column, which will not change as long as the `quizcard-generator` input/source file name and line number to which the note belongs don't change. Notes already within Anki according to `euid` will then be updated instead of creating duplicates.

#### Render control tags

Tags are an organizational concept already present in Anki, and the quiz card generator (quizgen) includes them in its notes export in order to later quickly isolate notes within Anki that came from quizgen, and among them from what source texts they are. However, in addition to organizational tags, quizgen also uses card render control tags.

Render control tags serve as dynamic options to change how a note's cards are rendered.
Below is a list of supported render control tags. They are all included by default in the exported notes, unless otherwise specified. See [`anki/anki_tag.ts:RenderControlTag`](https://github.com/ogallagher/quizcard-generator/blob/main/anki/anki_tag.ts) jsdoc comments for latest details.

- `qg-show-logging` Render log messages in a text area near the bottom of the card. **Not included** by default. If you want to see log messages, you can specify this tag in the program options, or add the tag within Anki after import.
- `qg-show-choices` Show the multiple choices for the tested word.
- `qg-show-source-file` Show the note's source file.
- `qg-show-source-line` Show the note's line number in its source file.
- `qg-show-randomized` Shuffle choices randomly on render.
- `qg-show-prologue` Show preceding text from the source file.
- `qg-show-epilogue` Show following text from the source file.
